# Item 5. 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라

## 개요
클래스는 하나 이상의 자원에 의존하는 경우가 많다. 이럴 때, 의존하는 자원을 정적 유틸리티 클래스로 구현하는 경우가 빈번하다. 허나 이는 아래와 같은 단점이 있다.
- 의존하는 자원의 구현체가 여러 가지가 될 수 있기에 유연하지 못한 설계이다
- 정적 클래스를 의존하게되면 테스트하기 어렵다

의존하는 필드에서 final 키워드를 제거하고 구현체를 교체해주는 메서드를 이용하여 여러 구현체를 가지게 할 수 있다. 하지만, 이는 의존 객체가 불변하지 않게 하고, 멀티 스레드 환경에서 문제가 생길 수 있다.

## 의존 객체 주입
인스턴스를 생성할 때, 생성자에 의존 객체의 구현체를 넘겨주는 방식이다.
- 장점
    - final 키워드와 함께 불변을 보장하여, 멀티 스레드에서 문제 없이 동작한다
    - 생성자에 넣는 구현체를 언제든 갈아끼울 수 있어 유연하게 변경 가능하다
    - 생성자, 정적 팩터리, 빌더 모두에 적용 가능하다
- 변형
    - 생성자에 의존 자원의 팩터리를 넘겨주는 방식
        - 클라이언트가 자신이 명시한 타입 하위의 모든 타입을 생성할 수 있는 팩터리를 넘길 수 있다
        ```java
        // 변형 전
        Mosaic create(Tile tile) {...}
        
        // 변형 후
        Mosaic create(Supplier<? extends Tile> tileFactory) {...}
        ```
- 단점
    - 의존성이 수 천 이상의 큰 프로젝트에서는 코드를 어지럽게 할 수 있음
        - 프레임워크를 사용하여 해소 가능

## 정리
클래스가 하나 이상의 자원에 의존하고, 그 자원이 클래스 동작에 영향을 준다면 싱글톤과 정적 유틸리티 클래스로 구현하는 것은 좋지 못하다. 또한, 클래스 내부에서 자원을 구현하는 것도 좋지 않다. 특정 구현체에 완전히 의존하게 되어 변경 사항이 생겼을 경우 수정해야할 코드가 많아지기 때문이다.

## 내 생각 정리
의존 객체 주입의 변형인 생성자에 의존 자원의 팩터리를 넘겨주는 방식에 대한 생각
- 장점
    - 클라이언트에서 구현체를 생성하지 않아도 되게 함
        - 이로 인해, Tile 하위 구현체를 클라이언트가 몰라도 된다
        - 이로 인해, 구현체가 늘어나거나 변경 사항이 생겨도 팩터리 클래스만 수정하면 됨
